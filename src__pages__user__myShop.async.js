"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[379],{10235:function(O,b,t){t.d(b,{GD:function(){return M},Gj:function(){return m},Iw:function(){return h},LG:function(){return a},MX:function(){return C},PY:function(){return l},QK:function(){return n},RB:function(){return Z},Sp:function(){return g},ZZ:function(){return B},_r:function(){return T},aV:function(){return S},b7:function(){return u},dt:function(){return f},fY:function(){return k},if:function(){return N},kh:function(){return W},lz:function(){return I},mg:function(){return D},t0:function(){return r},yC:function(){return o}});var s=t(87866),c=t(33746),_=c.Z.create({baseURL:"https://api.xxzh.cc",withCredentials:!1,crossDomain:!0,timeout:1e4});function d(e){return request({url:"/task/grab",withCredentials:!1,method:"post",data:e})}function C(){return(0,s.Z)({url:"/products/random",method:"get"})}function f(e){return(0,s.Z)({url:"/products/random/type",method:"get",params:e})}function n(e){return(0,s.Z)({url:"/wishlist/add",method:"post",data:e})}function l(e){return(0,s.Z)({url:"/wishlist/"+e,method:"get"})}function r(e,L){return(0,s.Z)({url:"/wishlist/delete/".concat(e,"/").concat(L),method:"delete"})}function u(e){return(0,s.Z)({url:"/orders/buy",method:"post",data:e})}function a(e){return(0,s.Z)({url:"/orders/buy/all",method:"get",params:e})}function h(e){return(0,s.Z)({url:"/orders/buy/pending",method:"get",params:e})}function m(e){return(0,s.Z)({url:"/orders/buy/processing",method:"get",params:e})}function S(e){return(0,s.Z)({url:"/orders/buy/refunding",method:"get",params:e})}function D(e){return(0,s.Z)({url:"/orders/buy/delivered",method:"get",params:e})}function o(e){return(0,s.Z)({url:"/products/search",method:"get",params:e})}function k(e){return(0,s.Z)({url:"/shop/".concat(e.shopId,"/available-products"),method:"get",params:e})}function M(e){return(0,s.Z)({url:"/shop/products/priceRange",method:"get",params:e})}function B(e){return(0,s.Z)({url:"/shop/".concat(e.shopId,"/orders"),method:"get",params:e})}function Z(e){return(0,s.Z)({url:"/shop/".concat(e,"/products"),method:"get",params:{size:100}})}function g(e){return(0,s.Z)({url:"/shop/".concat(e,"/order/summary"),method:"get",params:{shopId:e}})}function T(e){return(0,s.Z)({url:"/shop/".concat(e.shopId,"/payOrder"),method:"post",data:e})}function N(e){return(0,s.Z)({url:"/shop/listProduct",method:"post",data:e})}function I(e){return(0,s.Z)({url:"/shop/products/editPrice",method:"post",data:e})}function W(e){return(0,s.Z)({url:"/shop/removeProduct",method:"post",data:e})}},87866:function(O,b,t){var s=t(31759),c=t.n(s),_=t(33746),d=t(69194),C=t(18015),f=_.Z.create({baseURL:"https://api.xxzh.cc",withCredentials:!1,crossDomain:!0,timeout:1e5});f.interceptors.request.use(function(n){if(n.url==="/auth/register"||n.url==="/auth/login")return n;(n.url==="/user/apply"||n.url==="/loan/apply")&&(n.headers["Content-Type"]="multipart/form-data");var l=localStorage.getItem("token");return l&&(n.headers.Authorization="Bearer "+l),n},function(n){return console.log(n),Promise.reject(n)}),f.interceptors.response.use(function(n){var l,r=n.data;if(console.log("response-->",r),Array.isArray(r))return Promise.resolve(r);if((l=r.data)!==null&&l!==void 0&&l.token&&(localStorage.setItem("token",r.data.token),localStorage.setItem("userInfo",JSON.stringify(r.data.user))),r.code!==200)return d.FN.show({icon:"fail",content:r.message}),Promise.resolve(r);if(r.code===200||r.message==="SUCCESS")return Promise.resolve(r);if(r.code===305||r.code===306){Promise.reject(r||"error");return}else return r.code===403?(d.FN.show({icon:"fail",content:r.message}),C.history.push("/login"),Promise.resolve(r||"error")):Promise.reject(r||"error")},function(n){return console.log(n,"error"),n.status===403&&(d.FN.show({icon:"fail",content:n.message}),localStorage.removeItem("token"),setTimeout(function(){C.history.push("/login")},1e3)),console.log("request error"+n,c()(n)),Promise.reject(n)}),b.Z=f},72283:function(O,b,t){t.d(b,{Bi:function(){return f},Vj:function(){return n},c9:function(){return l},dN:function(){return C}});var s=t(25298),c=t.n(s),_=t(17069),d=t.n(_);function C(r){return isNaN(r)?"0.00":Number(r).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function f(r){var u=new Date(r),a=u.getFullYear(),h=String(u.getMonth()+1).padStart(2,"0"),m=String(u.getDate()).padStart(2,"0"),S="".concat(a,"-").concat(h,"-").concat(m);return S}function n(r,u,a){for(var h={},m=100/a,S=0;S<=a;S++){var D=S*m,o=(r+(u-r)*D/100).toFixed(2);h[D]=parseFloat(o)}return h}var l=function(){function r(u){c()(this,r),this.url=u,this.ws=null,this.listeners=[],this.onOpenCallbacks=[],this.onCloseCallbacks=[],this.onErrorCallbacks=[]}return d()(r,[{key:"connect",value:function(){var a=this;this.ws||(this.ws=new window.WebSocket(this.url),this.ws.onopen=function(){a.onOpenCallbacks.forEach(function(h){return h()})},this.ws.onmessage=function(h){var m=h.data;try{m=JSON.parse(m)}catch(S){}a.listeners.forEach(function(S){return S(m)})},this.ws.onclose=function(h){a.onCloseCallbacks.forEach(function(m){return m(h)})},this.ws.onerror=function(h){a.onErrorCallbacks.forEach(function(m){return m(h)})})}},{key:"send",value:function(a){console.log(this.ws,"this.ws"),!(!this.ws||this.ws.readyState!==1)&&(typeof a!="string"&&(a=JSON.stringify(a)),this.ws.send(a))}},{key:"onMessage",value:function(a){this.listeners.push(a)}},{key:"close",value:function(){this.ws&&(this.ws.close(),this.ws=null)}},{key:"onOpen",value:function(a){this.onOpenCallbacks.push(a)}},{key:"onClose",value:function(a){this.onCloseCallbacks.push(a)}},{key:"onError",value:function(a){this.onErrorCallbacks.push(a)}}]),r}()},57540:function(O,b,t){t.d(b,{Z:function(){return C}});var s=t(75271),c=t(69194),_=t(52676),d=function(n){var l=n.visible;return(0,_.jsx)(c.zd,{visible:l,className:"loading-mask",children:(0,_.jsxs)("div",{className:"loading-container",children:[(0,_.jsx)(c.wW,{style:{"--size":"48px"}}),(0,_.jsx)("span",{className:"loading-text",children:"Loading..."})]})})},C=d},84908:function(O,b,t){var s=t(69194),c=t(75271),_=t(5791),d=t(52676),C=function(n){var l=n.title,r=(0,_.s0)(),u=function(){r(-1)};return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(s.l2,{onBack:u,style:{background:"#fff",position:"sticky",top:0,zIndex:1e3},children:l})})};b.Z=C},90615:function(O,b,t){t.r(b),t.d(b,{default:function(){return M}});var s=t(90228),c=t.n(s),_=t(87999),d=t.n(_),C=t(48305),f=t.n(C),n=t(69194),l={finance:"finance___jMmXn",title:"title___Z5__3",content:"content___KfQBf",number:"number___tftMl",button:"button___uveoD",overlayContent:"overlayContent___yeZga"},r=t(72283),u=t(75271),a=t(10235),h=t(84908),m=t(57540),S=t(5791),D=t(59739),o=t(52676),k=function(){var Z=(0,D.$G)(),g=Z.t,T=(0,S.s0)(),N=(0,u.useState)({}),I=f()(N,2),W=I[0],e=I[1],L=(0,u.useState)(!1),K=f()(L,2),V=K[0],A=K[1],H=(0,u.useState)(""),z=f()(H,2),R=z[0],Y=z[1],Q=(0,u.useState)(!1),F=f()(Q,2),E=F[0],w=F[1],X=(0,u.useState)({}),$=f()(X,2),q=$[0],ee=$[1],te=(0,u.useState)([]),J=f()(te,2),G=J[0],ne=J[1],U=function(){var i=d()(c()().mark(function v(){var x,j,P;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return w(!0),x=JSON.parse(localStorage.getItem("userInfo")),j=x.shopId,p.next=4,(0,a.RB)(j);case 4:P=p.sent,ne(P.data),w(!1);case 7:case"end":return p.stop()}},v)}));return function(){return i.apply(this,arguments)}}(),re=function(){var i=d()(c()().mark(function v(x){var j,P;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!E){p.next=2;break}return p.abrupt("return");case 2:return w(!0),j=JSON.parse(localStorage.getItem("userInfo")),p.next=6,(0,a.kh)({shopId:j.shopId,productId:x.id});case 6:if(P=p.sent,P.code!==200){p.next=11;break}return n.FN.show({icon:"success",content:g("myshop.toastRemoveSuccess")}),p.next=11,U();case 11:w(!1);case 12:case"end":return p.stop()}},v)}));return function(x){return i.apply(this,arguments)}}(),oe=function(){var i=d()(c()().mark(function v(x){return c()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:A(!0),ee(x);case 2:case"end":return P.stop()}},v)}));return function(x){return i.apply(this,arguments)}}(),se=function(){var i=d()(c()().mark(function v(){var x,j;return c()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!E){y.next=2;break}return y.abrupt("return");case 2:if(R){y.next=5;break}return n.FN.show({icon:"fail",content:g("myshop.enterPricePrompt")}),y.abrupt("return");case 5:return w(!0),x=JSON.parse(localStorage.getItem("userInfo")),y.next=9,(0,a.lz)({shopId:x.shopId,productId:q.id,newPrice:R});case 9:if(j=y.sent,j.code!==200){y.next=15;break}return A(!1),n.FN.show({icon:"success",content:g("myshop.priceUpdateSuccess")}),y.next=15,U();case 15:w(!1);case 16:case"end":return y.stop()}},v)}));return function(){return i.apply(this,arguments)}}();return(0,u.useEffect)(function(){U()},[]),(0,o.jsxs)("div",{className:l.indexContainer,children:[(0,o.jsx)(m.Z,{visible:E}),(0,o.jsx)(n.zd,{visible:V,onMaskClick:function(){return A(!1)},children:(0,o.jsx)("div",{className:l.overlayContent,children:(0,o.jsxs)(n.Zb,{children:[(0,o.jsx)("h1",{children:g("myshop.editPrice")}),(0,o.jsx)("br",{}),(0,o.jsxs)("div",{className:l.content,children:[(0,o.jsx)("input",{type:"number",value:R,onChange:function(v){return Y(v.target.value)},placeholder:g("myshop.enterNewPrice")}),(0,o.jsx)("br",{}),(0,o.jsx)("div",{className:l.button,onClick:function(){return se()},style:{background:E?"#ccc":"#fb7701",pointerEvents:E?"none":"auto"},children:g(E?"myshop.submitting":"myshop.submit")})]})]})})}),(0,o.jsxs)("div",{className:l.indexBody,children:[(0,o.jsx)(h.Z,{title:g("myshop.title")}),G.length>0?(0,o.jsx)(n.aV,{style:{"--border-top":"none","--border-bottom":"none"},children:G.map(function(i){return(0,o.jsx)(n.aV.Item,{style:{fontWeight:i.unread?700:400,background:i.unread?"linear-gradient(90deg, #f5f7fa 0%, #fff 100%)":"#fff",borderRadius:8,margin:"8px 16px",boxShadow:i.unread?"0 2px 8px rgba(60,80,120,0.06)":"none"},children:(0,o.jsxs)("div",{style:{height:"120px",display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)("div",{style:{width:"40%",height:"100%"},children:(0,o.jsx)("img",{src:"https://api.xxzh.cc"+i.imagePath,style:{width:"100%",height:"100%",borderRadius:8}})}),(0,o.jsxs)("div",{style:{width:"58%",padding:"10px 0"},children:[(i==null?void 0:i.name)&&(0,o.jsx)(n.mH,{direction:"end",content:i==null?void 0:i.name,rows:2,style:{fontSize:"18px"}}),(0,o.jsx)("br",{}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)("p",{style:{color:"#fb7701",fontSize:"18px"},children:["$",(0,r.dN)((i==null?void 0:i.price)||0)]}),(0,o.jsx)("div",{children:(0,o.jsx)("button",{onClick:function(){return re(i)},disabled:E,style:{color:"#fff",background:E?"#ccc":"#fb7701",padding:"4px 8px",border:"none",fontSize:"14px",borderRadius:"8px",cursor:E?"not-allowed":"pointer"},children:g(E?"myshop.processing":"myshop.remove")})})]})]})]})},i.id)})}):(0,o.jsx)(n.HY,{style:{padding:"64px 0"},imageStyle:{width:128},description:g("myshop.noData")})]})]})},M=k}}]);
